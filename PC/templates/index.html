<!DOCTYPE html>
<html>
<head>
    <title>Industrial Safety Dashboard</title>
    <meta http-equiv="refresh" content="5">
    <style>
        body {
            font-family: 'Segoe UI', sans-serif;
            background-color: #121212;
            color: #f0f0f0;
            padding: 30px;
        }

        h1 {
            text-align: center;
            color: #00ffc3;
            margin-bottom: 30px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 30px;
        }

        th, td {
            padding: 12px 16px;
            border-bottom: 1px solid #333;
        }

        th {
            background-color: #1e1e1e;
            color: #00ffc3;
            text-align: left;
        }

        td {
            background-color: #1a1a1a;
        }

        .status-on {
            color: #00ff99;
            font-weight: bold;
        }

        .status-off {
            color: #ff4d4d;
            font-weight: bold;
        }

        .status-ok {
            color: #00eaff;
        }

        .status-warn {
            color: #ffa500;
        }

        .status-danger {
            color: #ff3333;
            font-weight: bold;
        }

        .button-group {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
        }

        button {
            background-color: #1f1f1f;
            color: #00ffc3;
            border: 2px solid #00ffc3;
            padding: 12px 24px;
            font-size: 16px;
            cursor: pointer;
            transition: background 0.3s, color 0.3s;
        }

        button:hover {
            background-color: #00ffc3;
            color: #1f1f1f;
        }

        ul {
            background-color: #1a1a1a;
            padding: 15px;
            border-radius: 5px;
        }

        ul li {
            margin-bottom: 5px;
        }

        .section-title {
            font-size: 18px;
            margin-top: 30px;
            color: #00ffc3;
        }
    </style>
</head>
<body>
    <h1>Industrial Safety Dashboard</h1>

    <table>
        <tr><th>Temperature</th><td>{{ state.temperature }} Â°C</td></tr>
        <tr><th>Humidity</th><td>{{ state.humidity }} %</td></tr>
        <tr><th>Light</th><td>{{ state.light }}</td></tr>
        <tr><th>Motion</th><td class="{{ 'status-danger' if state.motion == 'Yes' else 'status-ok' }}">{{ state.motion }}</td></tr>
        <tr><th>Fire</th><td class="{{ 'status-danger' if state.fire == 'Yes' else 'status-ok' }}">{{ state.fire }}</td></tr>
        <tr><th>Emergency</th><td class="{{ 'status-danger' if state.emergency == 'Emergency Stop' else 'status-ok' }}">{{ state.emergency }}</td></tr>
        <tr><th>Occupancy Zone 1</th><td>{{ state.occupancy_zone1 }}</td></tr>
        <tr><th>Occupancy Zone 2</th><td>{{ state.occupancy_zone2 }}</td></tr>
        <tr><th>Motor</th><td class="{{ 'status-on' if state.motor == 'ON' else 'status-off' }}">{{ state.motor }}</td></tr>
        <tr><th>Fan</th><td class="{{ 'status-on' if state.fan == 'ON' else 'status-off' }}">{{ state.fan }}</td></tr>
    </table>

    <div class="section-title">Last Plan Executed</div>
    <ul>
        {% for step in state.last_plan %}
        <li>{{ step }}</li>
        {% endfor %}
    </ul>

    <div class="section-title">Manual Override</div>
    <div class="button-group">
        <button onclick="sendCommand('on')">Force Motor ON</button>
        <button onclick="sendCommand('off')">Force Motor OFF</button>
        <button onclick="sendCommand('auto')">Return to AUTO Mode</button>
    </div>

    <script>
    function sendCommand(cmd) {
        fetch("/override", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ command: cmd })
        }).then(() => alert("Override '" + cmd + "' sent."));
    }
    </script>
</body>
</html>
